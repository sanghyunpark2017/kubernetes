
#일단 tomcat은 official 도커 이미지 사용하는 것으로 하여 테스트 한다.
#wasadm계정으로 구동하는 것은 DOCKERFILE로 부터 make해야 하며 필요시 나중에 실행


docker run -dit --name "tomcat7" tomcat:7
docker exec -it tomcat7 /bin/bash

cat /etc/*-release | uniq

apt-get update

apt-get install -y net-tools
apt-get install -y vim


#파일백업 스크립트
cd /sbin
vi bk
------------------------------------------------------------
#CP.ALL.ENABLE
for i in $*
do
        if [ -f $i ]
        then
                cp -pf "$1" "$1".`date +"%y%m%d.%H%M%S"`
        else
                echo "`basename $0` <filenames>"
        fi
done
------------------------------------------------------------

chmod 755 bk

#bash profile
cat << EOF >> /root/.bashrc
export PS1="\[\e[36;1m\]\u@\[\e[32;1m\]\h:\[\e[31;1m\]\w# \[\e[0m\]"
alias ll='ls -al'
EOF

#####################
#도커 기본 톰캣 수정
#####################

#설정백업
cd /usr/local/tomcat/connf
bk catalina.policy
bk catalina.properties
bk context.xml
bk logging.properties
bk server.xml
bk tomcat-users.xml
bk web.xml


#암호변경
#참조 https://geekflare.com/tomcat-login-problem/

bk /usr/local/tomcat/conf/tomcat-users.xml
sed -i 's/<must-be-changed>/CHANGEME/g' /usr/local/tomcat/conf/tomcat-users.xml
cat /usr/local/tomcat/conf/tomcat-users.xml

#설정백업
cd /usr/local/tomcat/connf
bk catalina.policy
bk catalina.properties
bk context.xml
bk logging.properties
bk server.xml
bk tomcat-users.xml
bk web.xml


#

















