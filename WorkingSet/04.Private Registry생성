
#싱글서버에 도커 설치
mkdir -p /app/registry/data
mkdir -p /app/registry/security

#docker run -d -p 5000:5000 -v /app/registry/data:/var/lib/registry --restart=always --name registry registry:2

docker run -d \
 --privileged \
  -p 5000:5000 \
  --restart=always \
  --name registry \
  -v /mnt/registry/:/var/lib/registry \
  -e REGISTRY_STORAGE_DELETE_ENABLED=true \
  registry:2.6.0


>>>>>>>>
https://docs.docker.com/registry/deploying/#get-a-certificate


#쿠베서버에 설정
bk /etc/docker/daemon.json
-------------------------------------------------------
cat << EOF > /etc/docker/daemon.json
{
  "insecure-registries" : ["localreg:5000"]
}
EOF
-------------------------------------------------------

cat << EOF >> /etc/hosts
10.10.64.89  localreg
EOF

systemctl restart docker
systemctl status docker

docker pull localreg:5000/mycentos7:base


#docker daemon --insecure-registry="10.10.64.89:5000"
#dockerd --insecure-registry="localreg:5000"
#kubectl create secret docker-registry my-secret --docker-server="https://your.private.repo" --docker-username=”USER” --docker-password=”PASS” --docker-email=”YOU@COMPANY”









#####################################################################################
https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/



docker login 또는 직접 /etc/docker/daemon.json 파일을 만든다


#regcred라는 이름으로
kubectl create secret docker-registry regcred --docker-server=<your-registry-server> --docker-username=<your-name> --docker-password=<your-pword> --docker-email=<your-email>

kubectl get secret regcred --output="jsonpath={.data.\.dockerconfigjson}" | base64 --decode

#그래서 이 것들을 이렇게 가져오게 한다
apiVersion: v1
kind: Pod
metadata:
  name: private-reg
spec:
  containers:
  - name: private-reg-container
    image: <your-private-image>
  imagePullSecrets:
  - name: regcred


#####################################################################################


  




































mkdir -p /etc/docker


yum install -y docker

systemctl start docker
systemctl enable docker


docker run -d -p 5000:5000 --name registry-srv registry:2
docker run -d -it -p 8080:8080 --name registry-web --link registry-srv -e REGISTRY_URL=http://registry-srv:5000/v2 -e REGISTRY_NAME=localhost:5000 hyper/docker-registry-web 



http://10.10.64.89:5000/v2/_catalog

